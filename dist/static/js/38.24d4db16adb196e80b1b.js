webpackJsonp([38],{Lrf2:function(s,a,t){s.exports=t("pZuO")},pZuO:function(s,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("section",[t("p",[t("a",{attrs:{href:"https://www.jianshu.com/p/68aad73963e8"}},[s._v("JS常见手写代码题（一）")])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.jianshu.com/p/69c8fbd8e064"}},[s._v("JS常见手写代码题（二）")])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/z858466/article/details/109286068"}},[s._v("32个手写JS_单眼皮的小熊-CSDN博客")])]),s._v(" "),t("ol",[t("li",[t("strong",[t("a",{attrs:{href:"https://www.notion.so/JS-2-a41d5177ff864e2db5a6ea87e8b7f464"}},[s._v("promise")]),s._v("、promise.all、promise.race")])]),s._v(" "),t("li",[t("strong",[t("a",{attrs:{href:"https://www.notion.so/JS-2-a41d5177ff864e2db5a6ea87e8b7f464"}},[s._v("instanceof")])])]),s._v(" "),t("li",[t("a",{attrs:{href:"https://www.notion.so/JS-2-a41d5177ff864e2db5a6ea87e8b7f464"}},[s._v("手写一个"),t("strong",[s._v("ajax")])])]),s._v(" "),t("li",[t("strong",[t("a",{attrs:{href:"https://www.notion.so/JS-2-a41d5177ff864e2db5a6ea87e8b7f464"}},[s._v("闭包cache")])])]),s._v(" "),t("li",[t("strong",[t("a",{attrs:{href:"https://www.notion.so/JS-2-a41d5177ff864e2db5a6ea87e8b7f464"}},[s._v("浅拷贝、深拷贝")])])]),s._v(" "),t("li",[t("strong",[t("a",{attrs:{href:"https://www.notion.so/JS-2-a41d5177ff864e2db5a6ea87e8b7f464"}},[s._v("字符串转驼峰")])])]),s._v(" "),t("li",[t("strong",[t("a",{attrs:{href:"https://www.notion.so/JS-2-a41d5177ff864e2db5a6ea87e8b7f464"}},[s._v("图片懒加载")])])]),s._v(" "),t("li",[t("a",{attrs:{href:"https://www.notion.so/JS-2-a41d5177ff864e2db5a6ea87e8b7f464"}},[s._v("滚动加载")])])]),s._v(" "),t("h1",[s._v("一、手写一个Promise")]),s._v(" "),t("h2",[t("strong",[s._v("Promise.all")])]),s._v(" "),t("p",[t("code",[s._v("Promise.all")]),s._v("是支持链式调用的，本质上就是返回了一个Promise实例，通过"),t("code",[s._v("resolve")]),s._v("和"),t("code",[s._v("reject")]),s._v("来改变实例状态。")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v(".myAll = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("promiseArr")]),s._v(") ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[s._v("("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" ans = [];\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" index = "),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v(";\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("for")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" i = "),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v("; i < promiseArr.length; i++) {\n      promiseArr[i]\n      .then("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("res")]),s._v(" =>")]),s._v(" {\n        ans[i] = res;\n        index++;\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (index === promiseArr.length) {\n          resolve(ans);\n        }\n      })\n      .catch("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("err")]),s._v(" =>")]),s._v(" reject(err));\n    }\n  })\n}\n")])]),s._v(" "),t("h2",[s._v("Promise.race")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v(".race = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("promiseArr")]),s._v(") ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[s._v("("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n    promiseArr.forEach("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("p")]),s._v(" =>")]),s._v(" {\n      "),t("span",{staticClass:"hljs-comment"},[s._v("// 如果不是Promise实例需要转化为Promise实例")]),s._v("\n      "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v(".resolve(p).then(\n        "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("val")]),s._v(" =>")]),s._v(" resolve(val),\n        err => reject(err),\n      )\n    })\n  })\n}\n")])]),s._v(" "),t("h2",[s._v("手写一个Promise")]),s._v(" "),t("p",[s._v("简单结构，伪代码")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-comment"},[s._v("// 1、首先声明一个构造函数Promise,里面有最基础的resolve\\reject方法，和一些状态值、返回值")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("executor")]),s._v(") ")]),s._v("{\n "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" self = "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(";\n "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".status = "),t("span",{staticClass:"hljs-string"},[s._v("'pending'")]),s._v("\n "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".value = "),t("span",{staticClass:"hljs-string"},[s._v("''")]),s._v("\n "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".reason = "),t("span",{staticClass:"hljs-string"},[s._v("''")]),s._v("\n "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".onResolvedCb = []\n "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".onRejectedCb = []\n "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("resolve")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("value")]),s._v(") ")]),s._v("{\n  self.value = value\n  self.status = "),t("span",{staticClass:"hljs-string"},[s._v("'resolved'")]),s._v("\n  self.onResolvedCb.forEach("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("fn")]),s._v(" =>")]),s._v(" fn())\n }\n "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("reject")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("err")]),s._v(") ")]),s._v("{\n  self.reason = err\n  self.status = "),t("span",{staticClass:"hljs-string"},[s._v("'rejected'")]),s._v("\n  self.onRejectedCb.forEach("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("fn")]),s._v(" =>")]),s._v(" fn())\n }\n "),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(" {\n  executor(resolve,reject)\n }"),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v("(error){\n  reject(error)\n }\n}\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 2、给promise原型绑定.then方法，包含了三个状态，在pending中会绑定回调")]),s._v("\n"),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v(".prototype.then = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("infulfilled,inrejected")]),s._v(") ")]),s._v("{\n "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" self = "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v("\n "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" promise2\n "),t("span",{staticClass:"hljs-comment"},[s._v("// .then返回的也是一个promise")]),s._v("\n "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".status == "),t("span",{staticClass:"hljs-string"},[s._v("'resolved'")]),s._v(") {\n  "),t("span",{staticClass:"hljs-comment"},[s._v("// 状态更改后，处理成功方法，并将结果解析至resolvePromise")]),s._v("\n   promise2 = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-comment"},[s._v("//x可能是一个promise，也可能是个普通值")]),s._v("\n    setTimeout("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(" {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" x = infulfilled(self.value)\n        resolvePromise(promise2, x, resolve, reject)\n      } "),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v(" (err) {\n        reject(err)\n      }\n    });\n\n  })\n } "),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".status == "),t("span",{staticClass:"hljs-string"},[s._v("'rejected'")]),s._v("){\n  "),t("span",{staticClass:"hljs-comment"},[s._v("// 状态为失败，处理失败方法，然后将结果解析")]),s._v("\n  promise2 = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") ")]),s._v("{\n   setTimeout("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(" {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" x = inrejected(self.value)\n      resolvePromise(promise2, x, resolve, reject)\n    } "),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v(" (err) {\n      reject(err)\n    }\n  })\n });\n } "),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".status == "),t("span",{staticClass:"hljs-string"},[s._v("'pending'")]),s._v(") {\n  "),t("span",{staticClass:"hljs-comment"},[s._v("// 状态为pending,将回调绑定进self的列表")]),s._v("\n  promise2 = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") ")]),s._v("{\n     self.onResolvedCallbacks.push("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n      "),t("span",{staticClass:"hljs-comment"},[s._v("//x可能是一个promise，也可能是个普通值")]),s._v("\n      setTimeout("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(" {\n          "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" x = infulfilled(self.value)\n          resolvePromise(promise2, x, resolve, reject)\n        } "),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v(" (err) {\n          reject(err)\n        }\n      });\n    })\n    self.onRejectedCallbacks.push("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n      "),t("span",{staticClass:"hljs-comment"},[s._v("//x可能是一个promise，也可能是个普通值")]),s._v("\n      setTimeout("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(" {\n          "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" x = inrejected(self.reason)\n          resolvePromise(promise2, x, resolve, reject)\n        } "),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v(" (err) {\n          reject(err)\n        }\n      });\n    })\n  })\n }\n "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" promise2\n}\n "),t("span",{staticClass:"hljs-comment"},[s._v("// 解析promise")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("resolvePromise")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("promise2, x, resolve, reject")]),s._v(") ")]),s._v("{\n "),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v("{\n  "),t("span",{staticClass:"hljs-comment"},[s._v("// "),t("span",{staticClass:"hljs-doctag"},[s._v("TODO:")]),s._v(" x也可能是个promise，对象中可能还有then，要进一步判断promise2")]),s._v("\n  resolve(x)\n } "),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v("(err){\n  reject(err)\n\n }\n}\n\n")])]),s._v(" "),t("p",[s._v("完整解析：")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/103651968"}},[s._v("https://zhuanlan.zhihu.com/p/103651968")])]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("executor")]),s._v(") ")]),s._v("{\n"),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" self = "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".status = "),t("span",{staticClass:"hljs-string"},[s._v("'pending'")]),s._v(" "),t("span",{staticClass:"hljs-comment"},[s._v("//当前状态")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".value = "),t("span",{staticClass:"hljs-literal"},[s._v("undefined")]),s._v("  "),t("span",{staticClass:"hljs-comment"},[s._v("//存储成功的值")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".reason = "),t("span",{staticClass:"hljs-literal"},[s._v("undefined")]),s._v(" "),t("span",{staticClass:"hljs-comment"},[s._v("//存储失败的原因")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".onResolvedCallbacks = []"),t("span",{staticClass:"hljs-comment"},[s._v("//存储成功的回调")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".onRejectedCallbacks = []"),t("span",{staticClass:"hljs-comment"},[s._v("//存储失败的回调")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("resolve")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("value")]),s._v(") ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (self.status == "),t("span",{staticClass:"hljs-string"},[s._v("'pending'")]),s._v(") {\n    self.status = "),t("span",{staticClass:"hljs-string"},[s._v("'resolved'")]),s._v("\n    self.value = value\n    self.onResolvedCallbacks.forEach("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("fn")]),s._v(" =>")]),s._v(" fn());\n  }\n}\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("reject")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("error")]),s._v(") ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (self.status == "),t("span",{staticClass:"hljs-string"},[s._v("'pending'")]),s._v(") {\n    self.status = "),t("span",{staticClass:"hljs-string"},[s._v("'rejected'")]),s._v("\n    self.reason = error\n    self.onRejectedCallbacks.forEach("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("fn")]),s._v(" =>")]),s._v(" fn())\n  }\n}\n"),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(" {\n  executor(resolve, reject)\n} "),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v(" (error) {\n  reject(error)\n}\n}\n"),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v(".prototype.then = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"},[s._v("infulfilled, inrejected")]),s._v(") ")]),s._v("{\n"),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" self = "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" promise2\ninfulfilled = "),t("span",{staticClass:"hljs-keyword"},[s._v("typeof")]),s._v(" infulfilled === "),t("span",{staticClass:"hljs-string"},[s._v("'function'")]),s._v(" ? infulfilled : "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"},[s._v("val")]),s._v(") ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" val\n}\ninrejected = "),t("span",{staticClass:"hljs-keyword"},[s._v("typeof")]),s._v(" inrejected === "),t("span",{staticClass:"hljs-string"},[s._v("'function'")]),s._v(" ? inrejected : "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"},[s._v("err")]),s._v(") ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("throw")]),s._v(" err\n}\n"),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".status == "),t("span",{staticClass:"hljs-string"},[s._v("'resolved'")]),s._v(") {\n  promise2 = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-comment"},[s._v("//x可能是一个promise，也可能是个普通值")]),s._v("\n    setTimeout("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(" {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" x = infulfilled(self.value)\n        resolvePromise(promise2, x, resolve, reject)\n      } "),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v(" (err) {\n        reject(err)\n      }\n    });\n\n  })\n}\n"),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".status == "),t("span",{staticClass:"hljs-string"},[s._v("'rejected'")]),s._v(") {\n\n  promise2 = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-comment"},[s._v("//x可能是一个promise，也可能是个普通值")]),s._v("\n    setTimeout("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(" {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" x = inrejected(self.reason)\n        resolvePromise(promise2, x, resolve, reject)\n      } "),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v(" (err) {\n        reject(err)\n      }\n    });\n  })\n}\n"),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".status == "),t("span",{staticClass:"hljs-string"},[s._v("'pending'")]),s._v(") {\n  promise2 = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") ")]),s._v("{\n    self.onResolvedCallbacks.push("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n      "),t("span",{staticClass:"hljs-comment"},[s._v("//x可能是一个promise，也可能是个普通值")]),s._v("\n      setTimeout("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(" {\n          "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" x = infulfilled(self.value)\n          resolvePromise(promise2, x, resolve, reject)\n        } "),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v(" (err) {\n          reject(err)\n        }\n      });\n    })\n    self.onRejectedCallbacks.push("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n      "),t("span",{staticClass:"hljs-comment"},[s._v("//x可能是一个promise，也可能是个普通值")]),s._v("\n      setTimeout("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(" {\n          "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" x = inrejected(self.reason)\n          resolvePromise(promise2, x, resolve, reject)\n        } "),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v(" (err) {\n          reject(err)\n        }\n      });\n    })\n  })\n}\n"),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" promise2\n}\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("resolvePromise")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("p2, x, resolve, reject")]),s._v(") ")]),s._v("{\n"),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (p2 === x && x != "),t("span",{staticClass:"hljs-literal"},[s._v("undefined")]),s._v(") {\n  reject("),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("TypeError")]),s._v("("),t("span",{staticClass:"hljs-string"},[s._v("'类型错误'")]),s._v("))\n}\n"),t("span",{staticClass:"hljs-comment"},[s._v("//可能是promise,看下对象中是否有then方法，如果有~那就是个promise")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (x !== "),t("span",{staticClass:"hljs-literal"},[s._v("null")]),s._v(" && ("),t("span",{staticClass:"hljs-keyword"},[s._v("typeof")]),s._v(" x === "),t("span",{staticClass:"hljs-string"},[s._v("'object'")]),s._v(" || "),t("span",{staticClass:"hljs-keyword"},[s._v("typeof")]),s._v(" x === "),t("span",{staticClass:"hljs-string"},[s._v("'function'")]),s._v(")) {\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(" {"),t("span",{staticClass:"hljs-comment"},[s._v("//为了防止出现 {then:11}这种情况,需要判断then是不是一个函数")]),s._v("\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" then = x.then\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("typeof")]),s._v(" then === "),t("span",{staticClass:"hljs-string"},[s._v("'function'")]),s._v(") {\n      then.call(x, "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"},[s._v("y")]),s._v(") ")]),s._v("{\n        "),t("span",{staticClass:"hljs-comment"},[s._v("//y 可能还是一个promise,那就再去解析，知道返回一个普通值为止")]),s._v("\n        resolvePromise(p2, y, resolve, reject)\n      }, "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"},[s._v("err")]),s._v(") ")]),s._v("{\n        reject(err)\n      })\n    } "),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" {"),t("span",{staticClass:"hljs-comment"},[s._v("//如果then不是function 那可能是对象或常量")]),s._v("\n      resolve(x)\n    }\n  } "),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v(" (e) {\n    reject(e)\n  }\n} "),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" {"),t("span",{staticClass:"hljs-comment"},[s._v("//说明是一个普通值")]),s._v("\n  resolve(x)\n}\n}\n")])]),s._v(" "),t("h1",[s._v("二、实现检测数据类型的instanceof")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[s._v("left表示要检测的数据，right表示类型。其原理是用原型链实现的，\nA(实例对象) "),t("span",{staticClass:"hljs-keyword"},[s._v("instanceof")]),s._v(" B(构造函数)。\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("instanceof")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("left, right")]),s._v(")")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" proto = left._proto_\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" prototype = right.prototype\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("while")]),s._v("("),t("span",{staticClass:"hljs-literal"},[s._v("true")]),s._v("){\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(proto === "),t("span",{staticClass:"hljs-literal"},[s._v("null")]),s._v(") "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-literal"},[s._v("false")]),s._v("\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(proto === prototype) "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-literal"},[s._v("true")]),s._v("\n        proto = proto._proto_\n    }\n}\n")])]),s._v(" "),t("h1",[s._v("三、ajax")]),s._v(" "),t("h3",[s._v("readyState的值")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8d4a5e9f-1ee4-4329-9547-474b45cf545a/Untitled.png",alt:"Untitled"}})]),s._v(" "),t("h3",[s._v("（1）get请求的ajax")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" xhr = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" XMLHttpRequest() "),t("span",{staticClass:"hljs-comment"},[s._v("//1、创建连接")]),s._v("\nxhr.open("),t("span",{staticClass:"hljs-string"},[s._v("'GET'")]),s._v(", url, "),t("span",{staticClass:"hljs-literal"},[s._v("true")]),s._v(") "),t("span",{staticClass:"hljs-comment"},[s._v("//2、连接服务器 true表示异步，false是同步")]),s._v("\nxhr.onreadystatechange = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{ "),t("span",{staticClass:"hljs-comment"},[s._v("//4、接收请求，当状态改变时触发这个函数")]),s._v("\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (xhr.readyState === "),t("span",{staticClass:"hljs-number"},[s._v("4")]),s._v(") {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (xhr.status === "),t("span",{staticClass:"hljs-number"},[s._v("200")]),s._v(") {"),t("span",{staticClass:"hljs-comment"},[s._v("//xhr.responseText是字符串需转换为JSON")]),s._v("\n            success("),t("span",{staticClass:"hljs-built_in"},[s._v("JSON")]),s._v(".parse(xhr.responseText))\n        } "),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" {\n            fail(xhr.status)\n        }\n    }\n}\nxhr.send("),t("span",{staticClass:"hljs-literal"},[s._v("null")]),s._v(") "),t("span",{staticClass:"hljs-comment"},[s._v("//3、发送请求")]),s._v("\n")])]),s._v(" "),t("h3",[s._v("（2）post请求的ajax")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" xhr = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" XMLHttpRequest() "),t("span",{staticClass:"hljs-comment"},[s._v("//1、创建连接")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" postData = {\n    "),t("span",{staticClass:"hljs-attr"},[s._v("userName")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'zhangshan'")]),s._v(",\n    "),t("span",{staticClass:"hljs-attr"},[s._v("passWord")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'xxx'")]),s._v("\n}\nxhr.open("),t("span",{staticClass:"hljs-string"},[s._v("'POST'")]),s._v(", url, "),t("span",{staticClass:"hljs-literal"},[s._v("true")]),s._v(") "),t("span",{staticClass:"hljs-comment"},[s._v("//2、连接服务器")]),s._v("\nxhr.onreadystatechange = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{ "),t("span",{staticClass:"hljs-comment"},[s._v("//4、接收请求，当状态改变时触发这个函数")]),s._v("\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (xhr.readyState === "),t("span",{staticClass:"hljs-number"},[s._v("4")]),s._v(") {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (xhr.status === "),t("span",{staticClass:"hljs-number"},[s._v("200")]),s._v(") {"),t("span",{staticClass:"hljs-comment"},[s._v("//xhr.responseText是字符串需转换为JSON")]),s._v("\n            success("),t("span",{staticClass:"hljs-built_in"},[s._v("JSON")]),s._v(".parse(xhr.responseText))\n        } "),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" {\n            fail(xhr.status)\n        }\n    }\n}\nxhr.send("),t("span",{staticClass:"hljs-built_in"},[s._v("JSON")]),s._v(".stringify(postData)) "),t("span",{staticClass:"hljs-comment"},[s._v("//3、发送请求(需发送字符串，将json转化成字符串)")]),s._v("\n")])]),s._v(" "),t("h3",[s._v("（3）用Promise优化")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("ajax")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("url")]),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[s._v("("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" xhr = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" XMLHttpRequest() "),t("span",{staticClass:"hljs-comment"},[s._v("//1、创建连接")]),s._v("\n        xhr.open("),t("span",{staticClass:"hljs-string"},[s._v("'GET'")]),s._v(", url, "),t("span",{staticClass:"hljs-literal"},[s._v("true")]),s._v(") "),t("span",{staticClass:"hljs-comment"},[s._v("//2、连接服务器")]),s._v("\n        xhr.onreadystatechange = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{ "),t("span",{staticClass:"hljs-comment"},[s._v("//4、接收请求，当状态改变时触发这个函数")]),s._v("\n            "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (xhr.readyState === "),t("span",{staticClass:"hljs-number"},[s._v("4")]),s._v(") {\n                "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (xhr.status === "),t("span",{staticClass:"hljs-number"},[s._v("200")]),s._v(") {"),t("span",{staticClass:"hljs-comment"},[s._v("//xhr.responseText是字符串需转换为JSON")]),s._v("\n                    resolve("),t("span",{staticClass:"hljs-built_in"},[s._v("JSON")]),s._v(".parse(xhr.responseText))\n                }"),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(xhr.status === "),t("span",{staticClass:"hljs-number"},[s._v("404")]),s._v("){\n                    reject("),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Error")]),s._v("("),t("span",{staticClass:"hljs-string"},[s._v("'404'")]),s._v("))\n                }\n            }\n        }\n        xhr.send("),t("span",{staticClass:"hljs-literal"},[s._v("null")]),s._v(") "),t("span",{staticClass:"hljs-comment"},[s._v("//3、发送请求")]),s._v("\n    })\n} \n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" url = "),t("span",{staticClass:"hljs-string"},[s._v("''")]),s._v("\najax(url)\n.then("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("res")]),s._v(" =>")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log("),t("span",{staticClass:"hljs-built_in"},[s._v("JSON")]),s._v(".parse(xhr.responseText)))\n.catch("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("err")]),s._v(" =>")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log(err))\n")])]),s._v(" "),t("h1",[s._v("四、闭包写一个cache缓存工具")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("creatCache")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" data = {} "),t("span",{staticClass:"hljs-comment"},[s._v("//隐藏数据，外部访问不到")]),s._v("\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("get")]),s._v("(key) {\n            "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" data[key]\n        },\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("set")]),s._v("(key, val) {\n            data[key] = val\n        }\n    }\n}\n"),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" c = creatCache()\nc.set("),t("span",{staticClass:"hljs-string"},[s._v("'name'")]),s._v(", "),t("span",{staticClass:"hljs-string"},[s._v("'jin'")]),s._v(")\n"),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log(c.get("),t("span",{staticClass:"hljs-string"},[s._v("'name'")]),s._v("))\n")])]),s._v(" "),t("h1",[s._v("五、浅拷贝、深拷贝")]),s._v(" "),t("p",[s._v("浅拷贝只复制对象的第一层属性、深拷贝是对对象的属性进行递归复制。")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-comment"},[s._v("//浅拷贝   （obj1为所要拷贝的对象）")]),s._v("\n"),t("span",{staticClass:"hljs-comment"},[s._v("//方式一：原始版本（obj1为所要拷贝的对象，obj2已经默认为一个对象）")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("shallowCopy")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("obj1, obj2")]),s._v(")")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("for")]),s._v("("),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" key "),t("span",{staticClass:"hljs-keyword"},[s._v("in")]),s._v(" obj1){\n        obj2[key] = obj1[key]\n    }\n}\n"),t("span",{staticClass:"hljs-comment"},[s._v("//方式一：优化版本（obj为所要拷贝的对象）")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("shallowClone")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("obj")]),s._v(")")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("("),t("span",{staticClass:"hljs-keyword"},[s._v("typeof")]),s._v(" obj !== "),t("span",{staticClass:"hljs-string"},[s._v("'object'")]),s._v(" || obj == "),t("span",{staticClass:"hljs-literal"},[s._v("null")]),s._v("){\n        "),t("span",{staticClass:"hljs-comment"},[s._v("//obj是null，或者不是对象和数组，直接返回")]),s._v("\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" obj\n    }\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" result\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(obj "),t("span",{staticClass:"hljs-keyword"},[s._v("instanceof")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Array")]),s._v("){\n        result = []\n    }"),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v("{\n        result = {}\n    }\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("for")]),s._v("("),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" key "),t("span",{staticClass:"hljs-keyword"},[s._v("in")]),s._v(" obj){"),t("span",{staticClass:"hljs-comment"},[s._v("// for in 遍历对象可枚举属性，包括其原型的属性和方法， ")]),s._v("\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(obj.hasOwnProperty(key)){ "),t("span",{staticClass:"hljs-comment"},[s._v("//保证key不是原型的属性")]),s._v("\n            "),t("span",{staticClass:"hljs-comment"},[s._v("//递归调用")]),s._v("\n            result[key] = obj[key]\n        }\n    }\n    "),t("span",{staticClass:"hljs-comment"},[s._v("//返回结果")]),s._v("\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" result\n}\n"),t("span",{staticClass:"hljs-comment"},[s._v("//方式二")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("shallowCopy")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("obj1, obj2")]),s._v(")")]),s._v("{\n    obj2 = "),t("span",{staticClass:"hljs-built_in"},[s._v("Object")]),s._v(".assign({}, obj1)\n}\n")])]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-comment"},[s._v("//深拷贝   （obj1为所要拷贝的对象）")]),s._v("\n"),t("span",{staticClass:"hljs-comment"},[s._v("//方式一：原始版本（obj1为所要拷贝的对象）   ")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("deepCopy")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("obj1, obj2")]),s._v(")")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("for")]),s._v("("),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" key "),t("span",{staticClass:"hljs-keyword"},[s._v("in")]),s._v(" obj1){"),t("span",{staticClass:"hljs-comment"},[s._v("// for in 遍历对象可枚举属性，包括其原型的属性和方法， 可用obj1.hasOwnPerporty(key)判断这个实例是否有这个属性")]),s._v("\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" item = obj1[key] \n        "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(item "),t("span",{staticClass:"hljs-keyword"},[s._v("instanceof")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Array")]),s._v("){ "),t("span",{staticClass:"hljs-comment"},[s._v("// 不能用typeof  item，因为不能区分对象和数组")]),s._v("\n            obj2[key] = []\n            deepCopy(item, obj2[key])\n        }"),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(item "),t("span",{staticClass:"hljs-keyword"},[s._v("instanceof")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Object")]),s._v("){\n            obj2[key] = {}\n            deepCopy(item, obj2[key])\n        }"),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v("{\n            obj2[key] = item\n        }\n    }\n}\n"),t("span",{staticClass:"hljs-comment"},[s._v("//方式一：优化版本（obj为所要拷贝的对象，obj2已经默认为一个对象）")]),s._v("\n思路："),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v("、判断是否是值类型还是引用类型。"),t("span",{staticClass:"hljs-number"},[s._v("2")]),s._v("、判断是数组还是对象。"),t("span",{staticClass:"hljs-number"},[s._v("3")]),s._v("、递归\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("deepClone")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("obj")]),s._v(")")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("("),t("span",{staticClass:"hljs-keyword"},[s._v("typeof")]),s._v(" obj !== "),t("span",{staticClass:"hljs-string"},[s._v("'object'")]),s._v(" || obj == "),t("span",{staticClass:"hljs-literal"},[s._v("null")]),s._v("){\n        "),t("span",{staticClass:"hljs-comment"},[s._v("//obj是null，或者不是对象和数组，直接返回")]),s._v("\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" obj\n    }\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" result\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(obj "),t("span",{staticClass:"hljs-keyword"},[s._v("instanceof")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Array")]),s._v("){\n        result = []\n    }"),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v("{\n        result = {}\n    }\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("for")]),s._v("("),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" key "),t("span",{staticClass:"hljs-keyword"},[s._v("in")]),s._v(" obj){"),t("span",{staticClass:"hljs-comment"},[s._v("// for in 遍历对象可枚举属性，包括其原型的属性和方法， ")]),s._v("\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(obj.hasOwnProperty(key)){ "),t("span",{staticClass:"hljs-comment"},[s._v("//保证key不是原型的属性")]),s._v("\n            "),t("span",{staticClass:"hljs-comment"},[s._v("//递归调用")]),s._v("\n            result[key] = deepClone(obj[key])\n        }\n    }\n    "),t("span",{staticClass:"hljs-comment"},[s._v("//返回结果")]),s._v("\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" result\n}\n缺陷：当遇到两个互相引用的对象，会出现死循环的情况。\n"),t("span",{staticClass:"hljs-comment"},[s._v("//方式二  ")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("deepCopy")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("obj1, obj2")]),s._v(")")]),s._v("{\n    obj2 = "),t("span",{staticClass:"hljs-built_in"},[s._v("JSON")]),s._v(".parse("),t("span",{staticClass:"hljs-built_in"},[s._v("JSON")]),s._v(".stringify(obj1))\n}\n缺陷：这种方法不能拷贝函数属性\n")])]),s._v(" "),t("h1",[s._v("六、字符串转驼峰")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[s._v("方法一：分割成数组，利用toUpperCase()转大写，substring（"),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v("）为第一个元素后面的元素\n"),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" str="),t("span",{staticClass:"hljs-string"},[s._v('"border-bottom-color"')]),s._v(";\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("tf")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(")")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" arr=str.split("),t("span",{staticClass:"hljs-string"},[s._v('"-"')]),s._v(");\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("for")]),s._v("("),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" i="),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v(";i<arr.length;i++){\n    arr[i]=arr[i].charAt("),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v(").toUpperCase()+arr[i].substring("),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v(");\n  }\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" arr.join("),t("span",{staticClass:"hljs-string"},[s._v('""')]),s._v(");\n};\ntf(str);\n\n方法二：正则\n"),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" str="),t("span",{staticClass:"hljs-string"},[s._v('"border-bottom-color"')]),s._v(";\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("tf")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(")")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" re="),t("span",{staticClass:"hljs-regexp"},[s._v("/-(\\w)/g")]),s._v(";\n  str=str.replace(re,"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("$"),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v(",$"),t("span",{staticClass:"hljs-number"},[s._v("1")])]),s._v(")")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" $"),t("span",{staticClass:"hljs-number"},[s._v("1.")]),s._v("toUpperCase();\n  });\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" str\n};\ntf(str);\n")])]),s._v(" "),t("h1",[s._v("七、图片懒加载")]),s._v(" "),t("p",[s._v("可以给img标签统一自定义属性data-src='default.png'，当检测到图片出现在窗口之后再补充src属性，此时才会进行图片资源加载。")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("lazyload")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" imgs = "),t("span",{staticClass:"hljs-built_in"},[s._v("document")]),s._v(".getElementsByTagName("),t("span",{staticClass:"hljs-string"},[s._v("'img'")]),s._v(");\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" len = imgs.length;\n  "),t("span",{staticClass:"hljs-comment"},[s._v("// 视口的高度")]),s._v("\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" viewHeight = "),t("span",{staticClass:"hljs-built_in"},[s._v("document")]),s._v(".documentElement.clientHeight;\n  "),t("span",{staticClass:"hljs-comment"},[s._v("// 滚动条高度")]),s._v("\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" scrollHeight = "),t("span",{staticClass:"hljs-built_in"},[s._v("document")]),s._v(".documentElement.scrollTop || "),t("span",{staticClass:"hljs-built_in"},[s._v("document")]),s._v(".body.scrollTop;\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("for")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" i = "),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v("; i < len; i++) {\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" offsetHeight = imgs[i].offsetTop;\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (offsetHeight < viewHeight + scrollHeight) {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" src = imgs[i].dataset.src;\n      imgs[i].src = src;\n    }\n  }\n}\n\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 可以使用节流优化一下")]),s._v("\n"),t("span",{staticClass:"hljs-built_in"},[s._v("window")]),s._v(".addEventListener("),t("span",{staticClass:"hljs-string"},[s._v("'scroll'")]),s._v(", lazyload);\n")])]),s._v(" "),t("h1",[s._v("八、滚动加载")]),s._v(" "),t("p",[s._v("原理就是监听页面滚动事件，分析clientHeight、scrollTop、scrollHeight三者的属性关系。")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-built_in"},[s._v("window")]),s._v(".addEventListener("),t("span",{staticClass:"hljs-string"},[s._v("'scroll'")]),s._v(", "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" clientHeight = "),t("span",{staticClass:"hljs-built_in"},[s._v("document")]),s._v(".documentElement.clientHeight;\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" scrollTop = "),t("span",{staticClass:"hljs-built_in"},[s._v("document")]),s._v(".documentElement.scrollTop;\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" scrollHeight = "),t("span",{staticClass:"hljs-built_in"},[s._v("document")]),s._v(".documentElement.scrollHeight;\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (clientHeight + scrollTop >= scrollHeight) {\n    "),t("span",{staticClass:"hljs-comment"},[s._v("// 检测到滚动至页面底部，进行后续操作")]),s._v("\n    "),t("span",{staticClass:"hljs-comment"},[s._v("// ...")]),s._v("\n  }\n}, "),t("span",{staticClass:"hljs-literal"},[s._v("false")]),s._v(");\n")])])])}]},l=t("VU/8")(null,n,!1,null,null,null);a.default=l.exports}});
//# sourceMappingURL=38.24d4db16adb196e80b1b.js.map