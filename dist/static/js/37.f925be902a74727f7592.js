webpackJsonp([37],{SZXL:function(s,a,t){s.exports=t("tDUa")},tDUa:function(s,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("section",[t("p",[s._v("参考文章：")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.yuque.com/along-n3gko/ezt5z9/vuie5p"}},[s._v("设计模式 · 语雀")])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://juejin.cn/post/6846687601785585677"}},[s._v("史上最全的JS设计模式（一）")])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/userkang/article/details/104288650"}})]),s._v(" "),t("p",[s._v("可以查看这一篇图文：")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://refactoringguru.cn/design-patterns"}},[s._v("常用设计模式有哪些？")])]),s._v(" "),t("p",[s._v("设计模式并不局限于某一种语言，它是**"),t("code",[s._v("解决特定场景的一系列通用方案和思维")]),s._v("**。我们所说的如单例模式、观察者模式，是为了理解和沟通，创建的专业术语。")]),s._v(" "),t("p",[s._v("设计模式是被反复验证的解决方案（最佳实践），可以减少代码强耦合、硬编码，有效的提高代码的可扩展性和可维护性，可以分为"),t("strong",[s._v("创建型、结构型和行为型")]),s._v("三类便于区分和理解")]),s._v(" "),t("h1",[s._v("一、创建型")]),s._v(" "),t("p",[s._v("处理对象创建机制，灵活判断针对某个实例创建所需对象。")]),s._v(" "),t("hr"),s._v(" "),t("h2",[s._v("1、模块模式")]),s._v(" "),t("ul",[t("li",[s._v("模块模式是在传统软件工程中为类提供私有和公有封装的方法。通过这种方式，让一个对象拥有私有和公有的方法/变量（js中用闭包实现），有效控制对外暴露的api接口，屏蔽底层处理逻辑。")])]),s._v(" "),t("p",[s._v("【"),t("strong",[s._v("应用场景】：需要管理大量私有变量/方法，希望屏蔽内部处理逻辑，只对外暴露接口的独立模块")])]),s._v(" "),t("h3",[s._v("原理与方案：")]),s._v(" "),t("p",[s._v("1、由于js曾经没有访问修饰符，从技术的角度来说，我们不能称js变量为私有和公有。所以我们需要使用 IIFE（即时调用函数表达式）、闭包和函数作用域的方式来实现js的模块模式。")]),s._v(" "),t("p",[s._v("2、IIFE使得obj会获得function中返回的对象，同时只有对象中的函数可以闭包访问到内部的count变量，达到私有的目的。")]),s._v(" "),t("p",[s._v("3、最终外部采用"),t("code",[s._v("**调用模块的公有属性/方法来访问和操作私有变量**")])]),s._v(" "),t("h3",[s._v("实现方式：")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" obj=("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(")")]),s._v("{    \n    "),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" count="),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v(";    \n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" {        \n        "),t("span",{staticClass:"hljs-attr"},[s._v("addCount")]),s._v(":"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(")")]),s._v("{ count++ },        \n        "),t("span",{staticClass:"hljs-attr"},[s._v("getCount")]),s._v(":"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(")")]),s._v("{ "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" count }    \n    }\n})()\nobj.addCount() "),t("span",{staticClass:"hljs-comment"},[s._v("// 1")]),s._v("\nobj.getCount() "),t("span",{staticClass:"hljs-comment"},[s._v("// 1")]),s._v("\nobj.count "),t("span",{staticClass:"hljs-comment"},[s._v("// undefined")]),s._v("\n采用封装的思想，只有本模块才能享有私有变量，不会暴露于外部模块\n减少对全局作用域的影响，避免命名空间污染；\n")])]),s._v(" "),t("h2",[s._v("2、单例模式")]),s._v(" "),t("ul",[t("li",[t("strong",[t("code",[s._v("确保一个类只有一个实例，并提供对该实例的全局访问")])]),s._v("。")])]),s._v(" "),t("p",[s._v("【"),t("strong",[s._v("应用场景】：登录弹窗、全局提示等")])]),s._v(" "),t("h3",[s._v("原理与方案：")]),s._v(" "),t("p",[s._v("单例模式限制某个类只能被创建一次，并且需要提供一个全局的访问点。如果一个类的实例不存在，单例模式就会创建一个新的类实例。如果实例存在，它只返回对该对象的引用。对构造函数的任何重复调用都会获取相同的对象。")]),s._v(" "),t("h3",[s._v("实现方式一：使用构造函数实现")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" instance = "),t("span",{staticClass:"hljs-literal"},[s._v("null")]),s._v(";\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("User")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{  \n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(instance) {    \n        "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" instance;  \n    }  \n    instance = "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(";  \n    "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".name = "),t("span",{staticClass:"hljs-string"},[s._v("'Peter'")]),s._v(";  \n    "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".age = "),t("span",{staticClass:"hljs-number"},[s._v("25")]),s._v(";  \n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" instance;\n}\n\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" user1 = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" User();\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" user2 = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" User();\n"),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log(user1 === user2); "),t("span",{staticClass:"hljs-comment"},[s._v("// 打印 true")]),s._v("\n")])]),s._v(" "),t("h3",[s._v("实现方式二：使用模块模式实现")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" singleton = ("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{  \n    "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" instance;  \n    "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("init")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{    \n        "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" {      \n            "),t("span",{staticClass:"hljs-attr"},[s._v("name")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'Peter'")]),s._v(",      \n            "),t("span",{staticClass:"hljs-attr"},[s._v("age")]),s._v(": "),t("span",{staticClass:"hljs-number"},[s._v("24")]),s._v(",    };  \n        }  \n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" {    \n        "),t("span",{staticClass:"hljs-attr"},[s._v("getInstance")]),s._v(": "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n            "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(!instance) {\n                instance = init();      \n            }      \n            "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" instance;    \n        }  \n    }\n})();\n\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" instanceA = singleton.getInstance();\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" instanceB = singleton.getInstance();\n"),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log(instanceA === instanceB); "),t("span",{staticClass:"hljs-comment"},[s._v("// 打印 true")]),s._v("\n")])]),s._v(" "),t("h2",[s._v("3、工厂模式")]),s._v(" "),t("ul",[t("li",[s._v("定义一个接口用于创建对象，但是让子类决定初始化哪个类。工厂方法把一个类的初始化下放到子类。")])]),s._v(" "),t("p",[s._v("【应用场景】")]),s._v(" "),t("h3",[s._v("原理与方案：")]),s._v(" "),t("p",[s._v("1、在简单工厂模式中，一个工厂类负责所有产品对象的创建；")]),s._v(" "),t("p",[s._v("2、将简单工厂模式进一步抽象化，实现"),t("strong",[s._v("工厂模式")]),s._v("：让工厂子类去实现抽象工厂类的接口，由"),t("strong",[s._v("每个具体的工厂类负责创建单独的产品")]),s._v("，如果有新的产品加进来，只需要增加一个具体的创建产品工厂类和具体的产品类就可以了，不会影响到已有的其他代码，代码量也不会变大，后期维护更加容易，增加了系统的可扩展性。")]),s._v(" "),t("h3",[s._v("实现方式：简单工厂模式")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-class"},[t("span",{staticClass:"hljs-keyword"},[s._v("class")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("Email")]),s._v(" ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("constructor")]),s._v("(options) {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".message = options.message || "),t("span",{staticClass:"hljs-string"},[s._v("'我是emial信息'")]),s._v(";\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".type = options.type || "),t("span",{staticClass:"hljs-string"},[s._v("'email'")]),s._v(",\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".sender = options.user;\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".receiver = options.receiver;\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".sendTime = options.sendTime || "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Date")]),s._v("()\n    }\n}\n"),t("span",{staticClass:"hljs-class"},[t("span",{staticClass:"hljs-keyword"},[s._v("class")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("Weixin")]),s._v(" ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("constructor")]),s._v("(options) {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".msg = options.message || "),t("span",{staticClass:"hljs-string"},[s._v("'我是微信信息'")]),s._v(";\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".type = options.type || "),t("span",{staticClass:"hljs-string"},[s._v("'weixin'")]),s._v(",\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".sender = options.user;\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".receiver = options.receiver;\n    }\n}\n"),t("span",{staticClass:"hljs-class"},[t("span",{staticClass:"hljs-keyword"},[s._v("class")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("MessageFactory")]),s._v(" ")]),s._v("{\n    create(options) {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("switch")]),s._v(" (option.type) {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("case")]),s._v(" "),t("span",{staticClass:"hljs-string"},[s._v("'email'")]),s._v(":\n            "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" Email(options);\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("case")]),s._v(" "),t("span",{staticClass:"hljs-string"},[s._v("'weixin'")]),s._v(":\n            "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" Weixin(options);\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("default")]),s._v(":\n            "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-literal"},[s._v("null")]),s._v(";\n        }\n    }\n}\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 通过MessageFactory中传参， options 对象中接收到的 type 属性创建和返回一个新的对象。")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" factory = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" MessageFactory();\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" emailMsg = factory.create({\n    "),t("span",{staticClass:"hljs-attr"},[s._v("type")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'email'")]),s._v(",\n    "),t("span",{staticClass:"hljs-attr"},[s._v("message")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'你好，有兴趣了解下安利吗'")]),s._v(",\n    "),t("span",{staticClass:"hljs-attr"},[s._v("user")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'xiaojia'")]),s._v(",\n    "),t("span",{staticClass:"hljs-attr"},[s._v("receiver")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'xx1'")]),s._v(",\n});\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" weixinMsg = factory.create({\n    "),t("span",{staticClass:"hljs-attr"},[s._v("type")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'weixin'")]),s._v(",\n    "),t("span",{staticClass:"hljs-attr"},[s._v("message")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'i m 卖保险'")]),s._v(",\n    "),t("span",{staticClass:"hljs-attr"},[s._v("user")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'xiaojia'")]),s._v(",\n    "),t("span",{staticClass:"hljs-attr"},[s._v("receiver")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'xx2'")]),s._v(",\n});\n")])]),s._v(" "),t("p",[s._v("以上方式如果要扩展，需要每次修改MessageFactory，因此可以将create移动到子工厂中，如下优化调用")]),s._v(" "),t("h3",[s._v("实现方式：工厂模式")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-class"},[t("span",{staticClass:"hljs-keyword"},[s._v("class")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("Email")]),s._v(" ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("constructor")]),s._v("(options) {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".message = options.message || "),t("span",{staticClass:"hljs-string"},[s._v("'我是emial信息'")]),s._v(";\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".type = options.type || "),t("span",{staticClass:"hljs-string"},[s._v("'email'")]),s._v(",\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".sender = options.user;\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".receiver = options.receiver;\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".sendTime = options.sendTime || "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Date")]),s._v("()\n    }\n}\n"),t("span",{staticClass:"hljs-class"},[t("span",{staticClass:"hljs-keyword"},[s._v("class")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("MessageFactory")]),s._v(" ")]),s._v("{\n    create(options) {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("throw")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Error")]),s._v("("),t("span",{staticClass:"hljs-string"},[s._v("'需要create方法'")]),s._v(") "),t("span",{staticClass:"hljs-comment"},[s._v("// 不能直接调用messageFactory创建")]),s._v("\n    }\n}\n"),t("span",{staticClass:"hljs-class"},[t("span",{staticClass:"hljs-keyword"},[s._v("class")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("EmailMsgFactory")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("extends")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("MessageFactory")]),s._v(" ")]),s._v("{\n    create(options) {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" Email(options)\n    }\n}\n\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 分别创建")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" factory = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" EmailMsgFactory();\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" emailMsg = factory.create({\n    "),t("span",{staticClass:"hljs-attr"},[s._v("type")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'email'")]),s._v(",\n    "),t("span",{staticClass:"hljs-attr"},[s._v("message")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'你好，有兴趣了解下安利吗'")]),s._v(",\n    "),t("span",{staticClass:"hljs-attr"},[s._v("user")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'xiaojia'")]),s._v(",\n    "),t("span",{staticClass:"hljs-attr"},[s._v("receiver")]),s._v(": "),t("span",{staticClass:"hljs-string"},[s._v("'xx1'")]),s._v(",\n});\n")])]),s._v(" "),t("h1",[s._v("二、结构型")]),s._v(" "),t("p",[s._v("**处理对象的组合，**将对象结合在一起形成更大的结构")]),s._v(" "),t("hr"),s._v(" "),t("h2",[s._v("1、代理模式")]),s._v(" "),t("ul",[t("li",[s._v("通过替身对象实现对访问动作的控制和处理")])]),s._v(" "),t("h3",[s._v("原理与方案：")]),s._v(" "),t("ol",[t("li",[s._v("代理模式的核心是为对象提供一个代理对象，来控制对目标对象的访问，客户其实访问的是这个代理对象。这样代理对象就可以对请求做出一些处理之后，再将请求转交给本体对象。")]),s._v(" "),t("li",[s._v("代理模式中常见的有保护代理、虚拟代理、缓存代理。")]),s._v(" "),t("li",[s._v("保护代理主要是限制了访问主体的行为，如过滤消息中的敏感信息；虚拟代理主要是在访问行为中加入一些额外操作，最常见的例子有函数防抖")])]),s._v(" "),t("h3",[s._v("实现方式：【例子：函数防抖】")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-comment"},[s._v("// 函数防抖，频繁操作中不处理，直到操作完成之后（再过 delay 的时间）才处理")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("debounce")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("fn, delay")]),s._v(") ")]),s._v("{\n    delay = delay || "),t("span",{staticClass:"hljs-number"},[s._v("200")]),s._v(";\n\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" timer = "),t("span",{staticClass:"hljs-literal"},[s._v("null")]),s._v(";\n\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" arg = "),t("span",{staticClass:"hljs-built_in"},[s._v("arguments")]),s._v(";\n\n        "),t("span",{staticClass:"hljs-comment"},[s._v("// 每次操作时，清除上次的定时器")]),s._v("\n        clearTimeout(timer);\n        timer = "),t("span",{staticClass:"hljs-literal"},[s._v("null")]),s._v(";\n\n        "),t("span",{staticClass:"hljs-comment"},[s._v("// 定义新的定时器，一段时间后进行操作")]),s._v("\n        timer = setTimeout("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n            fn.apply("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(", arg);\n        },\n        delay);\n    }\n};\n")])]),s._v(" "),t("h2",[s._v("2、装饰器模式")]),s._v(" "),t("ul",[t("li",[s._v("动态的给对象添加新的功能")])]),s._v(" "),t("h3",[s._v("原理与方案：")]),s._v(" "),t("p",[s._v("装饰器模式可以动态地给对象添加一些新功能。它是一种“即用即付”的方式，能够在不改变对象自身的基础上，在程序运行期间给对象动态地添加职责。")]),s._v(" "),t("h3",[s._v("实现方式：修改对象属性")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-comment"},[s._v("// 1、最简单的就是修改对象的属性")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" A = {    \n    "),t("span",{staticClass:"hljs-attr"},[s._v("score")]),s._v(": "),t("span",{staticClass:"hljs-number"},[s._v("10")]),s._v("\n};\n\nA.score = "),t("span",{staticClass:"hljs-string"},[s._v("'分数：'")]),s._v(" + A.score;\n\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 2、也可以通过构造函数和原型的方式来实现装饰器，并且经过多重包装可以形成一条装饰链")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("Person")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{}\n\nPerson.prototype.skill = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log("),t("span",{staticClass:"hljs-string"},[s._v("'数学'")]),s._v(");\n};\n\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 装饰器，还会音乐")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("MusicDecorator")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("person")]),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".person = person;\n}\n\nMusicDecorator.prototype.skill = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".person.skill();\n    "),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log("),t("span",{staticClass:"hljs-string"},[s._v("'音乐'")]),s._v(");\n};\n\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 装饰器，还会跑步")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("RunDecorator")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("person")]),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".person = person;\n}\n\nRunDecorator.prototype.skill = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".person.skill();\n    "),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log("),t("span",{staticClass:"hljs-string"},[s._v("'跑步'")]),s._v(");\n};\n\n"),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" person = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" Person();\n\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 装饰一下")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" person1 = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" MusicDecorator(person);\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 再装饰一下")]),s._v("\nperson1 = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" RunDecorator(person1);\n\nperson.skill(); "),t("span",{staticClass:"hljs-comment"},[s._v("// 数学")]),s._v("\nperson1.skill(); "),t("span",{staticClass:"hljs-comment"},[s._v("// 数学 音乐 跑步")]),s._v("\n")])]),s._v(" "),t("h1",[s._v("三、行为型")]),s._v(" "),t("p",[s._v("改善或者简化系统中不同对象之间的通信")]),s._v(" "),t("hr"),s._v(" "),t("h2",[s._v("1、观察者模式")]),s._v(" "),t("ul",[t("li",[s._v("定义了对象一对多的依赖关系。当目标对象状态发生变化后，会通知到所有的依赖对象")]),s._v(" "),t("li",[t("strong",[s._v("应用场景：")])]),s._v(" "),t("li",[s._v("对一个对象状态的更新，需要其他对象同步更新，而且其他对象的数量动态可变。")]),s._v(" "),t("li",[s._v("对象仅需要将自己的更新通知给其他对象而不需要知道其他对象的细节。")]),s._v(" "),t("li",[s._v("比如采购中，寻源结果审批通过后，会要通知相关采购负责人、自动创建合同信息等后续操作。")])]),s._v(" "),t("h3",[s._v("原理与方案：")]),s._v(" "),t("p",[s._v("观察者模式就是观察者和被观察者之间的通讯，主要用于一个对象（目标）去维持多个依赖于它的对象（观察者），将相关变更的事件自动通知给他们的场景。")]),s._v(" "),t("h3",[s._v("实现方式：")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-comment"},[s._v("// 主题，接收状态变化，触发每个观察者")]),s._v("\n"),t("span",{staticClass:"hljs-class"},[t("span",{staticClass:"hljs-keyword"},[s._v("class")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("Subject")]),s._v(" ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("constructor")]),s._v("() {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".state = "),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v("\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".observers = []\n  }\n  getState() {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".state\n  }\n  setState(state) {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".state = state\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".notifyAllObservers()"),t("span",{staticClass:"hljs-comment"},[s._v("// 2、subject执行setState状态变化时，会调用notifyAllObservers，")]),s._v("\n  }\n  attach(observer) {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".observers.push(observer)\n  }\n  notifyAllObservers() {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".observers.forEach("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("observer")]),s._v(" =>")]),s._v(" {\n          observer.update() "),t("span",{staticClass:"hljs-comment"},[s._v("// 3、触发observers更新")]),s._v("\n      })\n  }\n  remove(observer) {"),t("span",{staticClass:"hljs-comment"},[s._v("//移除")]),s._v("\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".observers.filter("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("item")]),s._v(" =>")]),s._v(" item === observer);\n  }\n}\n\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 观察者，等待被触发")]),s._v("\n"),t("span",{staticClass:"hljs-class"},[t("span",{staticClass:"hljs-keyword"},[s._v("class")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("Observer")]),s._v(" ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("constructor")]),s._v("(name, subject) {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".name = name\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".subject = subject\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".subject.attach("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(") "),t("span",{staticClass:"hljs-comment"},[s._v("// 1、observer构造时，通知subject有哪些观察者")]),s._v("\n  }\n  update() {\n      "),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log("),t("span",{staticClass:"hljs-string"},[s._v("`"),t("span",{staticClass:"hljs-subst"},[s._v("${"),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".name}")]),s._v(" update, state: "),t("span",{staticClass:"hljs-subst"},[s._v("${"),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".subject.getState()}")]),s._v("`")]),s._v(")\n\t\t\t"),t("span",{staticClass:"hljs-comment"},[s._v("// 4、执行update中的操作")]),s._v("\n\t\t\t\n  }\n}\n\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 测试代码")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" s = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" Subject()\n"),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" Observer("),t("span",{staticClass:"hljs-string"},[s._v("'o1'")]),s._v(", s)\n"),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" Observer("),t("span",{staticClass:"hljs-string"},[s._v("'o2'")]),s._v(", s)\n\ns.setState("),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v(") \n"),t("span",{staticClass:"hljs-comment"},[s._v("// 1、observer构造时，通知subject有哪些观察者")]),s._v("\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 2、subject执行setState状态变化时，会调用notifyAllObservers，")]),s._v("\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 3、触发observers更新")]),s._v("\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 4、观察者则执行update中的操作")]),s._v("\n\n-----------------------执行结果-----------------------\n  o1 update, "),t("span",{staticClass:"hljs-attr"},[s._v("state")]),s._v(": "),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v("\n\to2 update, "),t("span",{staticClass:"hljs-attr"},[s._v("state")]),s._v(": "),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v("\n")])]),s._v(" "),t("h2",[s._v("2、发布订阅模式")]),s._v(" "),t("ul",[t("li",[s._v("定义了对象一对多的依赖关系。当目标对象状态发生变化后，会通知到所有的依赖对象")])]),s._v(" "),t("h3",[s._v("原理与方案：")]),s._v(" "),t("ol",[t("li",[s._v("是观察者模式的一个别称")]),s._v(" "),t("li",[s._v("现在的发布订阅模式中，称为发布者的消息发送者不会将消息直接发送给订阅者，发布者和订阅者不知道彼此的存在。在发布者和订阅者之间存在第三个组件，称为调度中心或事件通道，它维持着发布者和订阅者之间的联系，过滤所有发布者传入的消息并相应地分发它们给订阅者。")]),s._v(" "),t("li",[s._v("就像微博动态，A就是发布者，你是订阅者，微博就是调度中心。")]),s._v(" "),t("li",[s._v("我们每个人在编程的时候都用过发布订阅模式，比如DOM事件绑定addEventListener、vue数据双向绑定。")])]),s._v(" "),t("h3",[t("strong",[s._v("和观察者模式的区别：")])]),s._v(" "),t("ul",[t("li",[s._v("在"),t("strong",[s._v("观察者")]),s._v("模式中"),t("strong",[s._v("直接通信")]),s._v("。然而在"),t("strong",[s._v("发布订阅")]),s._v("模式中只有"),t("strong",[s._v("通过消息代理进行通信")]),s._v("。")]),s._v(" "),t("li",[s._v("发布/订阅模式相比于观察者模式多了一个中间媒介，因为这个中间媒介，发布者和订阅者的"),t("strong",[s._v("关联更为松耦合")])]),s._v(" "),t("li",[t("strong",[s._v("观察者模式")]),s._v("大多数时候是"),t("strong",[s._v("同步")]),s._v("的，比如当事件触发，Subject就会去调用观察者的方法。而"),t("strong",[s._v("发布-订阅")]),s._v("模式大多数时候是"),t("strong",[s._v("异步的")]),s._v("。")])]),s._v(" "),t("p",[s._v("参考例子：")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.cnblogs.com/liquanjiang/p/11724793.html"}},[s._v("JavaScript设计模式之----原生JS实现简单的发布订阅模式")])]),s._v(" "),t("h3",[s._v("实现方式一：在DOM节点上面绑定事件函数，就属于发布—订阅模式")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-comment"},[s._v("// 监控用户点击document.body的动作，但是没办法预知用户将在什么时候点击。")]),s._v("\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 所以订阅document.body上的click事件，当body节点被点击时，body节点便会向订阅者发布这个消息。")]),s._v("\n"),t("span",{staticClass:"hljs-built_in"},[s._v("document")]),s._v(".body.addEventListener("),t("span",{staticClass:"hljs-string"},[s._v("'click'")]),s._v(","),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(")")]),s._v("{\n  alert("),t("span",{staticClass:"hljs-number"},[s._v("2")]),s._v(");\n},"),t("span",{staticClass:"hljs-literal"},[s._v("false")]),s._v(");\n"),t("span",{staticClass:"hljs-built_in"},[s._v("document")]),s._v(".body.click(); "),t("span",{staticClass:"hljs-comment"},[s._v("// //模拟用户点击")]),s._v("\n")])]),s._v(" "),t("h3",[s._v("实现方式二：一个基于对象的发布订阅的模型:")]),s._v(" "),t("p",[s._v("主要分为，订阅、触发、移除，简单来说就是将订阅的消息加进列表，当发布触发时，回调订阅列表中所有缓存的方法。")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" pubSub = {\n  "),t("span",{staticClass:"hljs-attr"},[s._v("subs")]),s._v(": [],\n  subscribe(key, fn) {  "),t("span",{staticClass:"hljs-comment"},[s._v("//订阅")]),s._v("\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (!"),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".subs[key]) {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".subs[key] = [];\n    }\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".subs[key].push(fn); "),t("span",{staticClass:"hljs-comment"},[s._v("// 订阅的消息添加进缓存列表，一个key可能对应多个fn组成的数组")]),s._v("\n  },\n  publish(...arg) { "),t("span",{staticClass:"hljs-comment"},[s._v("//发布")]),s._v("\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" args = arg;\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" key = args.shift();\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" fns = "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".subs[key];\n \n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (!fns || fns.length <= "),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v(") "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(";\n \n    "),t("span",{staticClass:"hljs-keyword"},[s._v("for")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" i = "),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v(", len = fns.length; i < len; i++) {\n      fns[i](args);\n    }\n  },\n  remove(key, fn) { "),t("span",{staticClass:"hljs-comment"},[s._v("// 取消订阅")]),s._v("\n\t\t"),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" fns = "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".subs[ key ];\n\t\t"),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ( !fns ){ "),t("span",{staticClass:"hljs-comment"},[s._v("// 如果key 没被人订阅，则直接返回")]),s._v("\n       "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-literal"},[s._v("false")]),s._v(";\n    }\n\t\t"),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ( !fn ){ "),t("span",{staticClass:"hljs-comment"},[s._v("// 如果没有传入具体函数，表示需要取消所有订阅")]),s._v("\n       fns && ( fns.length = "),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v(" );\n       "),t("span",{staticClass:"hljs-comment"},[s._v("// 也可以 delete this.subs[key]")]),s._v("\n    }"),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" { "),t("span",{staticClass:"hljs-comment"},[s._v("// 如果传入了具体函数，取消该函数的订阅")]),s._v("\n\t\t\t"),t("span",{staticClass:"hljs-keyword"},[s._v("for")]),s._v(" ( "),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" i = "),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v("; i < fns.length; i++ ){ \n          "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ( fns[ i ] === fn ){\n             fns.splice( i, "),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v(" ); "),t("span",{staticClass:"hljs-comment"},[s._v("// 删除订阅者的回调函数")]),s._v("\n          }\n      }\n\t\t}\n  }\n}\n\n"),t("span",{staticClass:"hljs-comment"},[s._v("//测试")]),s._v("\npubSub.subscribe("),t("span",{staticClass:"hljs-string"},[s._v("'name'")]),s._v(", name => {\n  "),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log("),t("span",{staticClass:"hljs-string"},[s._v("`your name is "),t("span",{staticClass:"hljs-subst"},[s._v("${name}")]),s._v("`")]),s._v(");\n})\npubSub.subscribe("),t("span",{staticClass:"hljs-string"},[s._v("'gender'")]),s._v(", gender => {\n  "),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log("),t("span",{staticClass:"hljs-string"},[s._v("`your name is "),t("span",{staticClass:"hljs-subst"},[s._v("${gender}")]),s._v("`")]),s._v(");\n})\npubSub.publish("),t("span",{staticClass:"hljs-string"},[s._v("'name'")]),s._v(", "),t("span",{staticClass:"hljs-string"},[s._v("'leaf333'")]),s._v(");  "),t("span",{staticClass:"hljs-comment"},[s._v("// your name is leaf333")]),s._v("\npubSub.publish("),t("span",{staticClass:"hljs-string"},[s._v("'gender'")]),s._v(", "),t("span",{staticClass:"hljs-string"},[s._v("'18'")]),s._v(");  "),t("span",{staticClass:"hljs-comment"},[s._v("// your gender is 18")]),s._v("\n")])]),s._v(" "),t("h3",[s._v("实现方式三：一个基于class的发布订阅模式的模版，考虑到了边界条件和匿名函数，属于一个比较完整的实现")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-class"},[t("span",{staticClass:"hljs-keyword"},[s._v("class")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("Pubsub")]),s._v(" ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("constructor")]),s._v(" () {\n  }\n\n  list = {};\n\n  "),t("span",{staticClass:"hljs-comment"},[s._v("// 添加消息监听的方法")]),s._v("\n  subscribe (topic, func) {\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("typeof")]),s._v(" topic !== "),t("span",{staticClass:"hljs-string"},[s._v("'string'")]),s._v(") {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("throw")]),s._v(" "),t("span",{staticClass:"hljs-string"},[s._v("'topic为字符串类型'")]),s._v("\n    }\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("typeof")]),s._v(" func !== "),t("span",{staticClass:"hljs-string"},[s._v("'function'")]),s._v(") {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("throw")]),s._v(" "),t("span",{staticClass:"hljs-string"},[s._v("'func为函数类型'")]),s._v("\n    }\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" list = "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".list;\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (!list[topic]) {\n      list[topic] = [];\n    }\n    list[topic].push(func);    "),t("span",{staticClass:"hljs-comment"},[s._v("// 为了防止匿名函数的影响，在添加时将取消监听的方法返回")]),s._v("\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("()")]),s._v(" =>")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".unsubscribe(topic, func);\n  }\n\n  "),t("span",{staticClass:"hljs-comment"},[s._v("// 发布消息的方法")]),s._v("\n  publish (topic, data) {\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("typeof")]),s._v(" topic !== "),t("span",{staticClass:"hljs-string"},[s._v("'string'")]),s._v(") {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("throw")]),s._v(" "),t("span",{staticClass:"hljs-string"},[s._v("'topic必须是字符串类型'")]),s._v("\n    }\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" list = "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".list;\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(!list[topic]) {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("throw")]),s._v(" "),t("span",{staticClass:"hljs-string"},[s._v("'不存在该事件的监听'")]),s._v("\n    } "),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" {\n      list[topic].forEach("),t("span",{staticClass:"hljs-function"},[s._v("("),t("span",{staticClass:"hljs-params"},[s._v("func")]),s._v(")=>")]),s._v("{\n        func.call("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(", data)\n      })\n    }\n  }\n\n  "),t("span",{staticClass:"hljs-comment"},[s._v("// 移除消息监听的方法")]),s._v("\n  unsubscribe (topic, func){\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("("),t("span",{staticClass:"hljs-keyword"},[s._v("typeof")]),s._v(" topic !== "),t("span",{staticClass:"hljs-string"},[s._v("'string'")]),s._v(") {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("throw")]),s._v(" "),t("span",{staticClass:"hljs-string"},[s._v("'topic为字符串类型'")]),s._v("\n    }\n\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(func && ("),t("span",{staticClass:"hljs-keyword"},[s._v("typeof")]),s._v(" func !== "),t("span",{staticClass:"hljs-string"},[s._v("'function'")]),s._v(")) {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("throw")]),s._v(" "),t("span",{staticClass:"hljs-string"},[s._v("'func为函数类型'")]),s._v("\n    }\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" list = "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".list;\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(!list[topic]) {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("throw")]),s._v(" "),t("span",{staticClass:"hljs-string"},[s._v("'不存在该topic监听'")]),s._v("\n    }\n\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(!func) { "),t("span",{staticClass:"hljs-comment"},[s._v("// 如果没有第二个参数，就移除所有的监听事件")]),s._v("\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(list[topic]) {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("delete")]),s._v(" list[topic]\n      }\n    } "),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" {\n      "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(!list[topic].includes(func)) {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("throw")]),s._v(" "),t("span",{staticClass:"hljs-string"},[s._v("'要移除的事件不存在'")]),s._v("\n      } "),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" index = list[topic].findIndex("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("item")]),s._v(" =>")]),s._v(" item === func);\n        list[topic].splice(index, "),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v(");\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(list[topic].length === "),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v(") {\n          "),t("span",{staticClass:"hljs-keyword"},[s._v("delete")]),s._v(" list[topic]\n        }\n      }\n    }\n  }\n}\n")])]),s._v(" "),t("h2",[s._v("3、策略模式")]),s._v(" "),t("ul",[t("li",[s._v("定义多个策略类实现具体算法，定义一个环境类通过请求参数来决定使用哪些策略")])]),s._v(" "),t("h3",[s._v("原理与方案：")]),s._v(" "),t("ol",[t("li",[s._v("策略模式的意义是定义一系列的算法，把它们一个个封装起来，并且使它们可相互替换。具体实现是由多个策略类实现具体算法，然后由一个环境类来通过请求参数决定使用哪些策略。")]),s._v(" "),t("li",[s._v("策略模式利用组合、委托等方法，可以有效避免多个if条件语句。适合用于组合一系列算法，或者组合一系列相同目的的业务规则。")])]),s._v(" "),t("h3",[s._v("实现方式:【举例】")]),s._v(" "),t("pre",[t("code",{staticClass:"language-jsx"},[t("span",{staticClass:"hljs-comment"},[s._v("// 优化前，用一个方法，根据等级不同，调用不同的计算规则")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" calculateBouns = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("salary, level")]),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (level === "),t("span",{staticClass:"hljs-string"},[s._v("'A'")]),s._v(") {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" salary * "),t("span",{staticClass:"hljs-number"},[s._v("4")]),s._v(";\n    }\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (level === "),t("span",{staticClass:"hljs-string"},[s._v("'B'")]),s._v(") {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" salary * "),t("span",{staticClass:"hljs-number"},[s._v("3")]),s._v(";\n    }\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" (level === "),t("span",{staticClass:"hljs-string"},[s._v("'C'")]),s._v(") {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" salary * "),t("span",{staticClass:"hljs-number"},[s._v("2")]),s._v(";\n    }\n}; \n\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 调用如下：")]),s._v("\n"),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log(calculateBouns("),t("span",{staticClass:"hljs-number"},[s._v("4000")]),s._v(","),t("span",{staticClass:"hljs-string"},[s._v("'A'")]),s._v(")); "),t("span",{staticClass:"hljs-comment"},[s._v("// 16000")]),s._v("\n"),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log(calculateBouns("),t("span",{staticClass:"hljs-number"},[s._v("2500")]),s._v(","),t("span",{staticClass:"hljs-string"},[s._v("'B'")]),s._v(")); "),t("span",{staticClass:"hljs-comment"},[s._v("// 7500")]),s._v("\n\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 用策略模式优化后，")]),s._v("\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 将具体策略封装起来，可以看到代码职责更新分明，代码变得更加清晰。")]),s._v("\n"),t("span",{staticClass:"hljs-comment"},[s._v("// 并且代码的可拓展性更强，增加/修改策略，只需要在策略集合obj中去维护.")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" obj = {\n    "),t("span",{staticClass:"hljs-string"},[s._v('"A"')]),s._v(": "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("salary")]),s._v(") ")]),s._v("{\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" salary * "),t("span",{staticClass:"hljs-number"},[s._v("4")]),s._v(";\n    },\n    "),t("span",{staticClass:"hljs-string"},[s._v('"B"')]),s._v(": "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("salary")]),s._v(") ")]),s._v("{\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" salary * "),t("span",{staticClass:"hljs-number"},[s._v("3")]),s._v(";\n    },\n    "),t("span",{staticClass:"hljs-string"},[s._v('"C"')]),s._v(": "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("salary")]),s._v(") ")]),s._v("{\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" salary * "),t("span",{staticClass:"hljs-number"},[s._v("2")]),s._v(";\n    }\n};\n"),t("span",{staticClass:"hljs-keyword"},[s._v("var")]),s._v(" calculateBouns = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("level, salary")]),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" obj[level](salary);\n};\n"),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log(calculateBouns("),t("span",{staticClass:"hljs-string"},[s._v("'A'")]),s._v(", "),t("span",{staticClass:"hljs-number"},[s._v("10000")]),s._v(")); "),t("span",{staticClass:"hljs-comment"},[s._v("// 40000")]),s._v("\n")])]),s._v(" "),t("h3",[s._v("应用场景")]),s._v(" "),t("p",[s._v("策略模式也常用于表单验证，定义不同的规则校验方法，调用验证的时候只需要传入规则名即可。")]),s._v(" "),t("p",[s._v("优点：")]),s._v(" "),t("ul",[t("li",[s._v("减少if-else，代码更整洁直观")]),s._v(" "),t("li",[s._v("提供开放-封闭原则，代码更容易理解和扩展")])])])}]},l=t("VU/8")(null,n,!1,null,null,null);a.default=l.exports}});
//# sourceMappingURL=37.f925be902a74727f7592.js.map